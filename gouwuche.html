
<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<script src="https://www.jq22.com/jquery/jquery-3.3.1.js"></script>
		<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
		<style>
			[v-cloak] {
				display: none;
			}
			.go_no1{
				overflow: hidden;
			}
			.go_no1 span{
				display: inline-block;
				width: 20%;
				text-align: center;
				float: left;
				line-height: 50px;
			}
			
		</style>
	</head>

	<body>
		<div id="box" class="container" v-cloak="">
			<div style="height:60px;line-height: 60px;border-bottom: 1px solid #ccc;text-align: right;">
				<button class="btn btn-success" data-toggle="modal" data-target="#myModal">购物车</button>
			</div>
			<div style="overflow: hidden;line-height: 50px;">
				<div style="float: left; width: 200px;margin: 5px;" v-for="i in arr">
					<div style="width: 200px;height: 200px;background: #ccc;">

					</div>
					<div>
						商品：{{i.n}}
					</div>
					<div>
						价格：{{i.j}} <button style="float: right;" class="btn" @click="insert_go(i)">  + </button>
					</div>
				</div>
			</div>
			<!--购物车-->
			<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							<h4 class="modal-title" id="myModalLabel">购物车</h4>
						</div>
						<div class="modal-body">
							<div v-if="go_arr.length">
									<div class="go_no1">
										<span>商品</span>
										<span>单价</span>
										<span>数量</span>
										<span>小计</span>
										<span>操作</span>
									</div>
								<div style="max-height: 400px;overflow-y: auto;">
									<div v-for="i in type_arr">
									<h4>{{i}}</h4>
									<div class="go_no1" v-for="a in go_arr" v-if="i ==a.t">
										<span>{{a.n}}</span>
										<span>{{a.j}}</span>
										<span>
											<button class="btn" @click="no1(a.uid)"> - </button>
											{{a.s}}
											<button class="btn" @click="no2(a.uid)"> + </button>
										</span>
										<span>{{a.j*a.s}}</span>
										<span><button class="glyphicon glyphicon-remove btn btn-danger" @click="delete_s(a.uid)"></button></span>
									</div>
								</div>
								</div>
								<div style="border-top: 1px solid #ccc; line-height: 40px;text-align: right;">
									总价：{{z_arr}}
								</div>
							</div>
							<div v-else>
								购物暂时没有数据
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-primary">支付</button>
						</div>
					</div>
				</div>
			</div>
			<!---->
		</div>
	</body>
	<script src="vue.js"></script>
	<script>
		new Vue({
			el: "#box",
			computed: {
				z_arr(){
					var num = 0
					for(var i = 0; i < this.go_arr.length; i++) {
						num+= this.go_arr[i].j*this.go_arr[i].s
					}
					return num
				},
				type_arr() {
					var arr = []
					for(var i = 0; i < this.go_arr.length; i++) {
						if(arr.indexOf(this.go_arr[i].t) == -1) {
							arr.push(this.go_arr[i].t)
						}
					}
					return arr
				}
			},
			methods: {
				delete_s(uid){
					for(var i = 0; i < this.go_arr.length; i++) {
						if(this.go_arr[i].uid == uid) {
							this.go_arr.splice(i,1)
						}
					}
				},
				no1(uid){
					for(var i = 0; i < this.go_arr.length; i++) {
						if(this.go_arr[i].uid == uid) {
							var num = this.go_arr[i].s
							num--
							if(num<=0){
								num=1
								alert('最后一个了')
							}
							this.$set(this.go_arr[i], 's', num)
						}
					}
				},
				no2(uid){
					for(var i = 0; i < this.go_arr.length; i++) {
						if(this.go_arr[i].uid == uid) {
							var num = this.go_arr[i].s
							num++
							this.$set(this.go_arr[i], 's', num)
						}
					}
				},
				insert_go(data) {
					var type = true
					for(var i = 0; i < this.go_arr.length; i++) {
						if(this.go_arr[i].uid == data.uid) {
							type = false
							var num = this.go_arr[i].s
							num++
							this.$set(data, 's', num)
						}
					}
					if(type) {
						this.$set(data, 's', 1)
						this.go_arr.push(data)
					}
				}
			},
			data: {
				arr: [{
						uid: 1,
						n: '苹果',
						t: '水果',
						j: 4
					},
					{
						uid: 2,
						n: '香蕉',
						t: '水果',
						j: 6
					},
					{
						uid: 3,
						n: '西瓜	',
						t: '水果',
						j: 2
					},
					{
						uid: 4,
						n: '衣柜',
						t: '家具',
						j: 4999
					},
					{
						uid: 5,
						n: '木质衣架',
						t: '家具',
						j: 299
					},
					{
						uid: 6,
						n: '衬衫',
						t: '服饰',
						j: 9.9
					},
					{
						uid: 7,
						n: '牛仔裤',
						t: '服饰',
						j: 99
					},
					{
						uid: 8,
						n: '三星',
						t: '电子产品',
						j: 5999
					},
					{
						uid: 9,
						n: '小米',
						t: '电子产品',
						j: 1999
					}
				],
				go_arr: []
			}
		})
	</script>

</html>